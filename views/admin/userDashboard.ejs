<main class="dashboard-container">
  <section class="reviews-section">
    <h2><%= locals.user.name %>‚Äôs Book Reviews</h2>

    <% if (!locals.reviews || locals.reviews.length === 0) { %>
      <p>You have not written any reviews yet.</p>
    <% } else { %>
      <ul class="reviews-list">
        <% reviews.forEach(review => { %>
          <li>
            <a href="/user/<%= review.review_id %>" class="review-item">
              <div class="review-header">
                <strong><%= review.book_title %></strong>
                <div class="star-rating">
                  <% 
                    let stars = Math.round(review.rating / 2); 
                    for (let i = 1; i <= 5; i++) { 
                  %>
                    <span class="<%= i <= stars ? 'star filled' : 'star' %>">&#9733;</span>
                  <% } %>
                  <span class="rating-text">(<%= review.rating %>/10)</span>
                </div>
              </div>

              <div class="review-actions">
                <a href="/auth/<%= user.user_id %>/edit-review?review_id=<%= review.review_id %>" class="edit-icon" title="Edit Review" aria-label="Edit Review">‚úèÔ∏è</a>
                <form
                  action="/auth/user/<%= user.user_id %>/delete-review"
                  method="POST"
                  class="delete-form"
                  onsubmit="return confirm('Are you sure you want to delete this review?');"
                >
                  <input type="hidden" name="review_id" value="<%= review.review_id %>" />
                  <button type="submit" class="delete-button" title="Delete Review" aria-label="Delete Review">üóëÔ∏è</button>
                </form>
              </div>
            </a>
          </li>
        <% }) %>
      </ul>
    <% } %>
  </section>

  <section class="add-review-section">
    <h3>Add a Review</h3>
    <div class="add-review-buttons">
      <% if (!locals.books || locals.books.length === 0) { %>
        <p>No books available to review. Please add books first.</p>
      <% } else { %>
        <% books.forEach(book => { %>
          <a 
            href="/auth/<%= user.user_id %>/add-review?book_id=<%= book.book_id %>" 
            class="btn btn-secondary"
            title="Add review for <%= book.title %>"
          >
            Review: <%= book.title %>
          </a>
        <% }) %>
      <% } %>
    </div>
  </section>
  <section class="user-banner">
    <div class="user-info">
        <p><strong>User ID:</strong> <%= user.user_id %></p>
        <p><strong>Name:</strong> <%= user.name %></p>
        <p><strong>Email:</strong> <%= user.email %></p>
        <p><strong>About:</strong> <%= user.about || 'N/A' %></p>
        <p><strong>Phone:</strong> <%= user.phone_number || 'N/A' %></p>
        <p><strong>Favorite Book:</strong> 
          <% if (user.favorite_book_title) { %>
            <%= user.favorite_book_title %>
          <% } else { %>
            N/A
          <% } %>
        </p>
      </div>
      <a href="/auth/user/<%= user.user_id %>/edit" class="edit-icon" title="Edit Profile" aria-label="Edit Profile">
        ‚úèÔ∏è
      </a>
  </section>
</main>
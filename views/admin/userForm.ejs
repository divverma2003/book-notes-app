<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Book Notes App</title>
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
  <%- include("partials/authHeader", { user: user }) %>

  <main class="form-container">
    <h2 class="form-title">Edit Profile</h2>

    <% if (typeof error !== 'undefined') { %>
      <p class="form-error"><%= error %></p>
    <% } %>

    <form action="/auth/user/edit/<%= user.user_id %>" method="POST" class="form">
      <label for="name">Name</label>
      <input
        type="text"
        name="name"
        id="name"
        required
        value="<%= user.name %>"
        placeholder="Your full name"
      />

      <label for="email">Email</label>
      <input
        type="email"
        name="email"
        id="email"
        required
        value="<%= user.email %>"
        placeholder="you@example.com"
      />

      <!-- Password left blank; only fill to change -->
      <label for="password">Password (leave blank to keep current)</label>
      <input
        type="password"
        name="password"
        id="password"
        placeholder="New password"
      />

      <label for="phone">Phone (optional)</label>
      <input
        type="tel"
        name="phone"
        id="phone"
        value="<%= user.phone || '' %>"
        placeholder="(555) 123-4567"
      />

      <label for="about">About You</label>
      <textarea
        name="about"
        id="about"
        rows="3"
        placeholder="Tell us something about yourself"
      ><%= user.about || '' %></textarea>

      <label for="favorite_book">Favorite Book</label>
      <select name="favorite_book" id="favorite_book" required>
        <option value="" disabled>Select a book</option>
        <% books.forEach(book => { %>
          <option
            value="<%= book.book_id %>"
            <%= book.book_id === user.favorite_book_id ? 'selected' : '' %>
          ><%= book.title %></option>
        <% }) %>
      </select>

      <label for="theme_color">Dashboard Theme</label>
      <select name="theme_color" id="theme_color" required>
        <% const themes = [
          'pastel-blue',
          'pastel-green',
          'pastel-yellow',
          'pastel-pink',
          'pastel-purple',
          'pastel-orange',
          'pastel-red',
          'pastel-gray',
          'pastel-brown'
        ]; %>
        <option value="" disabled>Select a color palette</option>
        <% themes.forEach(theme => { %>
          <option
            value="<%= theme %>"
            <%= user.theme_color === theme ? 'selected' : '' %>
          ><%= theme.replace('pastel-', '').replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase()) %></option>
        <% }) %>
      </select>

      <button type="submit" class="btn btn-primary">Save Changes</button>
    </form>
  </main>

  <%- include("partials/footer") %>
</body>
</html>
